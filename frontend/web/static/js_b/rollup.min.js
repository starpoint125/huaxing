/****************************************************************
 *																*		
 * 						      代码库							*
 *                        www.dmaku.com							*
 *       		  努力创建完善、持续更新插件以及模板			*
 * 																*
****************************************************************/
function action() {
    $(document.body).append('<div id="roll" style="display:none;"><div title="回到顶部" id="roll_top"></div></div>');
    $("#roll_top").click(function () {
        $("html,body").animate({
            scrollTop: "0px"
        }, 800)
    });
    $("#ct").click(function () {
        $("html,body").animate({
            scrollTop: $(".ct").offset().top
        }, 800)
    });

    $(document.body).append($("div.h_wrap").clone().addClass("h_head_gd").hide());
    var div = $("div.h_head_gd");
    $(window).scroll(function (a) {

        if ($(this).scrollTop() > 260) {
            $("#roll").fadeIn()
        } else {
            $("#roll").fadeOut()
        }

        if ($(this).scrollTop() > 145) {
            div.show()
        } else {
            div.hide()
        }

    }).scroll();

    var ie6 = ! -[1, ] && !window.XMLHttpRequest;
    if (ie6) {
        $("div.erji").parent().hover(function () {
            $(this).children("div").show();
        }, function () {
            $(this).children("div").hide();
        })
    }
};
/*在线客服开始
function imState(){$.get("/ajax.ashx?action=imstate&t="+Math.random(),function(rsp){window.imInfo=eval("("+rsp+")");if(imInfo.imShow){$.getScript("/UserControls/Im/im.js?t="+Math.random(),function(){writeIm(imInfo.imData);});}else{$("#divOranIm").hide();}});}
$(function(){$("body").append("<div style='width:150px;z-index:10;' id='divOranIm'></div>");imState();});
*/
function SelectMenu() {
//    var $menu = $("div.h_nav").eq(0);
//    var length = 0;
//    var _cur = "cur";
//    var $info = $("div.plc,div.plc2,div.pro_curmbs").find("a");
//    var getCurrUrl = function (href) {
//        href = href || '';
//        var length = href.length;
//        var index = href.lastIndexOf('/');
//        if (index + 1 == length) {
//            if ('/new/help/job/feedback/friendlink/neatupload/product/project/search/user/'.concat(href)) {
//                index = href.indexOf('/');
//                length = length - 1
//            } else {
//                index = href.indexOf('/', index - 9)
//            }
//        }
//        href = href.substr(index, length);
//        if (!href.match(/\.[shtml|html|aspx]{4,5}/) && href.lastIndexOf('/') != href.length - 1) {
//            href = href + "/"
//        }
//        return href;
//    }
//    var href = '';
//    length = length == 0 ? $info.size() : length;
//    var as = $menu.find('a');
//    while (length > 0) {
//        href = $info.eq(length - 1).attr('href');
//        var url = getCurrUrl(href).toLowerCase();
//        for (var i = 0; i < as.length; i++) {
//            var href = as.eq(i).attr('href').toLowerCase() + '/';
//            if (href.indexOf(url) > -1) {
//                as.eq(i).addClass(_cur).parents('li').addClass(_cur);
//                length = -1;
//                return;
//            }
//        }
//        length = length - 1
//    }
//    if (length != -1) {
//        $menu.find('li:eq(0)').addClass(_cur);
//    }
};

$(function () {
    var value = $('#seachkeywords').val();
    $('#seachkeywords').focus(function () {
        if (this.value == value) {
            this.value = '';
        }
    }).blur(function () {
        if (this.value == '') {
            this.value = value;
        }
    }).keypress(function (event) {
        if (event.keyCode == '13') {
            $('#sousuo').click();
            return false;
        }
    });
    $('#sousuo').click(function () {
        var xz = $('#seachkeywords').val();
        if (xz == value) {
            xz = "";
        }
        window.location.href = '/Search/Index.aspx?objtype=product&kwd=' + xz;
    });
    SelectMenu();
    action();
    var max = 100;
    var doyoo_share = $("#doyoo_share iframe");
    var _interval = setInterval(function () {
        doyoo_share = $("#doyoo_share iframe");
        if (max < 0 && doyoo_share.length) {
            if (doyoo_share.attr("src") == "about:blank") {
                doyoo_share.remove();
            }
            clearInterval(_interval);
        }
        max--;
    }, 10);
})